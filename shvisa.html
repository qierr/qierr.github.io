<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>ä¸Šæµ·ç­¾è¯ç”³è¯·</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
          font-family: 'Arial', sans-serif;
          background-color: #f8f9fa;
        }
    
        .visa-preview {
          position: relative;
          width: 100%;
          max-width: 600px;
          aspect-ratio: 3/2;
          background-image: url('img/shvisa.jpg');
          background-size: cover;
          background-position: center;
          border: 1px solid #ccc;
          border-radius: 10px;
          padding: 20px;
          color: #000;
          font-size: 14px;
          display: none;
        }
    
        .visa-text {
          position: absolute;
          white-space: nowrap;
          font-weight: bold;
        }
        .visa-preview::before {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.5); 
      z-index: 0;
    }
        .photo {
          position: absolute;
          top: 70px;
          left: 30px;
          width: 100px;
          height: 120px;
          border: 1px solid #000;
          object-fit: cover;
          background-color: #eee;
        }
    
        
        #title     { top: 5px;  left: 15px; font-size: 35px;}
        #title-e     { top: 22px;  left: 180px; font-size: 20px;}
        #cat-l     { top: 50px;  left: 220px; font-size: smaller;}
        #cat       { top: 60px;  left: 220px; font-size: larger;}
        #issue-l     { top: 90px;  left: 220px; font-size: smaller;}
        #issue     { top: 100px;  left: 220px; font-size: larger;}
        #expiry-l    { top: 90px;  left: 360px; font-size: smaller;}
        #expiry    { top: 100px;  left: 360px; font-size: larger;}
        #entry-l     { top: 130px; left: 220px; font-size: smaller;}
        #entry     { top: 140px; left: 220px; font-size: larger;}
        #duration-l  { top: 130px; left: 310px; font-size: smaller;}
        #duration  { top: 140px; left: 310px; font-size: larger;}
        #place-l     { top: 130px; left: 465px; font-size: smaller;}
        #place     { top: 140px; left: 465px; font-size: larger;}
        #name-l     { top: 168px; left: 220px; font-size: smaller;}
        #name      { top: 180px; left: 220px; font-size: larger;}
        #sex-l     { top: 210px; left: 220px; font-size: smaller;}
        #sex       { top: 220px; left: 220px; font-size: larger;}
        #birth-l     { top: 210px; left: 320px; font-size: smaller;}
        #birth     { top: 220px; left: 320px; font-size: larger;}
        #passport-l  { top: 210px; left: 455px; font-size: smaller;}
        #passport  { top: 220px; left: 4550px; font-size: larger;}
        #remarks-l   { top: 280px; left: 220px; font-size: smaller;}
        #remarks   { top: 290px; left: 220px; font-size: larger;}
        #mrcode1   { top: 330px; left: 30px; font-family: monospace; font-size: larger;}
        #mrcode2   { top: 350px; left: 30px; font-family: monospace; font-size: larger;}
    
        .form-section input, .form-section select {
          margin-bottom: 1rem;
        }
        @media (max-width: 767.98px) {
      .row {
        flex-direction: column;
      }
      .visa-preview {
        width: 100%;
        aspect-ratio: unset;
        height: auto;
        padding-bottom: 120%;
      }
    
      .visa-text {
        font-size: 3.5vw;
      }
    
      .photo {
        width: 20vw;
        height: 24vw;
        top: 15vw;
        left: 6vw;
      }
    
      
      #title     { top: 2vw; left: 5vw; font-size: 6vw; }
      #title-e   { top: 4vw; left: 40vw; font-size: 4vw; }
      #cat-l     { top: 15vw; left: 40vw; }
      #cat       { top: 18vw; left: 40vw; }
      #issue-l   { top: 23vw; left: 40vw; }
      #issue     { top: 26vw; left: 40vw; }
      #expiry-l  { top: 32vw; left: 40vw; }
      #expiry    { top: 35vw; left: 40vw; }
      #entry-l   { top: 40vw; left: 40vw; }
      #entry     { top: 43vw; left: 40vw; }
      #duration-l{ top: 48vw; left: 40vw; }
      #duration  { top: 51vw; left: 40vw; }
      #place-l   { top: 56vw; left: 40vw; }
      #place     { top: 59vw; left: 40vw; }
      #name-l    { top: 64vw; left: 40vw; }
      #name      { top: 67vw; left: 40vw; }
      #sex-l     { top: 72vw; left: 40vw; }
      #sex       { top: 75vw; left: 40vw; }
      #birth-l   { top: 80vw; left: 40vw; }
      #birth     { top: 83vw; left: 40vw; }
      #passport-l{ top: 88vw; left: 40vw; }
      #passport  { top: 91vw; left: 40vw; }
      #remarks-l { top: 96vw; left: 40vw; }
      #remarks   { top: 99vw; left: 40vw; }
      #mrcode1   { top: 108vw; left: 5vw; }
      #mrcode2   { top: 111vw; left: 5vw; }
    }
    </style>
</head>

<body class="container py-4">
    <h3 class="mb-4">ä¸Šæµ·ç­¾è¯ç”³è¯·</h3>
    <div class="row">
        <div class="col-md-5 form-section" id="visaform">
            <label>å§“å</label>
            <input type="text" id="fullName" class="form-control" placeholder="ç‹æ²ªå®"/>

            <label>æ€§åˆ«</label>
            <select id="gender" class="form-select">
                <option value="">è¯·é€‰æ‹©</option>
                <option value="M">ç”·</option>
                <option value="F">å¥³</option>
            </select>

            <label>å‡ºç”Ÿæ—¥æœŸ</label>
            <input type="date" id="birthDate" class="form-control" value="2005-01-01" />

            <label>æŠ¤ç…§å·</label>
            <input type="text" id="passportNumber" class="form-control" value="E" />
            <input class="form-check-input" type="checkbox" id="haveCHNP" />
            <label class="form-check-label" for="haveCHNP">
                æˆ‘æŒæœ‰ä¸­åäººæ°‘å…±å’Œå›½èº«ä»½è¯
            </label>
            <br>
            <label>èµ´æ²ªç›®çš„</label>
            <select id="purpose" class="form-select">
                <option value="">è¯·é€‰æ‹©</option>
                <option value="B2">æ—…æ¸¸</option>
                <option value="B1">å•†åŠ¡</option>
                <option value="F">ç•™å­¦</option>
                <option value="R">æ¢äº²</option>
                <option value="M">ç§»æ°‘</option>
                <option value="T">è¿‡å¢ƒ</option>
            </select>
            <input class="form-check-input" type="checkbox" id="withMixue" />
            <label class="form-check-label" for="withMixue">
                æœ€è¿‘5å¹´æ˜¯å¦è´­ä¹°/é¥®ç”¨èœœé›ªå†°åŸï¼ˆæ€»éƒ¨ä½äºæ²³å—éƒ‘å·ï¼‰æ——ä¸‹äº§å“
            </label>
            <br>
            <input class="form-check-input" type="checkbox" id="withMixue" />
            <label class="form-check-label" for="withMixue">
                æœ€è¿‘5å¹´æ˜¯å¦è´­ä¹°/é¥®ç”¨ç‘å¹¸å’–å•¡æ——ä¸‹äº§å“
            </label>
            <br>
            <input class="form-check-input" type="checkbox" id="withMixue" />
            <label class="form-check-label" for="withMixue">
                æœ€è¿‘5å¹´æ˜¯å¦è´­ä¹°/é¥®ç”¨æ˜Ÿå·´å…‹æ——ä¸‹äº§å“
            </label>
            <br>
            <label>ä½ çš„å‡ºç”Ÿåœ°</label>
            <select id="birthRegion" class="form-select">
                <option value="">è¯·é€‰æ‹©</option>
                <option value="A">æµ·å¤–</option>
                <option value="B">åŒ—äº¬ã€å¹¿å·ã€æ·±åœ³</option>
                <option value="C">å¤©æ´¥ã€é‡åº†</option>
                <option value="D">æ²³å—çœ</option>
                <option value="E">å…¶ä»–çœä»½</option>
            </select>
            <br>
            <label>ä½ çš„æœ€é«˜å­¦å†</label>
            <select id="study" class="form-select">
                <option value="">è¯·é€‰æ‹©</option>
                <option value="A">æœ¬ç§‘</option>
                <option value="B">ç ”ç©¶ç”Ÿ</option>
                <option value="C">åšå£«</option>
                <option value="D">å…¶å®ƒ</option>
            </select>
            <br>






            <label>ä¸Šä¼ ç…§ç‰‡</label>
            <input type="file" id="photoUpload" class="form-control" accept="image/*" />
            <button class="btn btn-primary mt-3" onclick="calculateScore()">æäº¤ç­¾è¯ç”³è¯·</button>
            
        </div>
        <div id="resultArea" class="alert mt-3"></div>
        <div class="col-md-7 d-flex justify-content-center align-items-start">
            <div class="visa-preview" id="visacard">
                <img id="visaPhoto" class="photo" src="https://via.placeholder.com/100x120?text=ç…§ç‰‡" alt="Visa Photo" />
                <div id="title" class="visa-text">ä¸Šæµ·ç­¾è¯</div>
                <div id="title-e" class="visa-text">Visa of Shanghai</div>
                <div id="cat-l" class="visa-text">ç­¾è¯ç±»å‹ / Visa Type</div>
                <div id="cat" class="visa-text">L</div>

                <div id="issue-l" class="visa-text">ç­¾å‘æ—¥æœŸ / Issue Date</div>
                <div id="issue" class="visa-text"></div>

                <div id="expiry-l" class="visa-text">æœ‰æ•ˆæœŸè‡³ / Valid Until</div>
                <div id="expiry" class="visa-text"></div>

                <div id="entry-l" class="visa-text">æ¬¡æ•° / Entries</div>
                <div id="entry" class="visa-text">M</div>

                <div id="duration-l" class="visa-text">åœç•™å¤©æ•° / Duration (Days)</div>
                <div id="duration" class="visa-text"></div>

                <div id="place-l" class="visa-text">ç­¾å‘åœ°ç‚¹ / Place of Issue</div>
                <div id="place" class="visa-text">Online</div>

                <div id="name-l" class="visa-text">å§“å / Name</div>
                <div id="name" class="visa-text"></div>

                <div id="sex-l" class="visa-text">æ€§åˆ« / Gender</div>
                <div id="sex" class="visa-text"></div>

                <div id="birth-l" class="visa-text">å‡ºç”Ÿæ—¥æœŸ / Date of Birth</div>
                <div id="birth" class="visa-text"></div>

                <div id="passport-l" class="visa-text">æŠ¤ç…§å· / Passport Number</div>
                <div id="passport" class="visa-text"></div>

                <div id="remarks-l" class="visa-text">å¤‡æ³¨ / Remarks</div>
                <div id="remarks" class="visa-text">-</div>
                <div id="mrcode1" class="visa-text">VCJCHANN&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</div>
                <div id="mrcode2" class="visa-text">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById("haveCHNP").addEventListener("change", function () {
        const passportInput = document.getElementById("passportNumber");
        if (this.checked) {
          passportInput.disabled = true;
          passportInput.value = "ä¸­å›½å±…æ°‘æ— éœ€å¡«å†™";
          
    
        } else {
          passportInput.disabled = false;
          passportInput.value = "";
        }
      });
      function calculateScore() {
        const name = document.getElementById("fullName").value.trim();
        const gender = document.getElementById("gender").value;
        const birthDate = document.getElementById("birthDate").value;
        const purposes = document.getElementById("purpose").value;
        const birthRegions = document.getElementById("birthRegion").value;
        const studys = document.getElementById("study").value;
        const photo = document.getElementById("photoUpload").files.length;
        if (!name || !gender || !birthDate || !purposes || !birthRegions || !studys || !photo) {
          alert("è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹å¹¶ä¸Šä¼ ç…§ç‰‡ï¼");
          return;
        }

        let score = 39;
    
        const isCHN = document.getElementById("haveCHNP").checked;
        if (isCHN) score -= 10;
    
        const purpose = document.getElementById("purpose").value;
        if (purpose === "B1" || purpose === "F" || purpose === "R") score += 20;
        else if (purpose === "B2") score -= 10;
        else if (purpose === "T") score += 5;
        else if (purpose === "M") score -= 10;
    
        const checkboxes = document.querySelectorAll("#withMixue");
        if (checkboxes[0]?.checked) score -= 10; // èœœé›ªå†°åŸ
        if (checkboxes[1]?.checked) score += 5; // ç‘å¹¸
        if (checkboxes[2]?.checked) score += 10;  // æ˜Ÿå·´å…‹
    
        const birthRegion = document.getElementById("birthRegion").value;
        if (birthRegion === "A") score += 20;
        else if (birthRegion === "B") score += 10;
        else if (birthRegion === "C") score += 5;
        else if (birthRegion === "D") score -= 20;
        else if (birthRegion === "E") score -= 10;

        const study = document.getElementById("study").value;
        if (birthRegion === "A") score += 10;
        else if (birthRegion === "B") score += 15;
        else if (birthRegion === "C") score += 20;
        else if (birthRegion === "D") score -= 20;
    
    
        let resultText = "";
        let alertClass = "";
        
        if (score >= 80) {
          resultText = `<strong>ğŸ‰ æ­å–œï¼è¿™æ˜¯æ‚¨çš„ä¸Šæµ·ç­¾è¯ï¼Œä½ ç°åœ¨å¯ä»¥å…¥å¢ƒä¸Šæµ·</strong>`;
          document.getElementById("duration").textContent = "N/A";
          document.getElementById("expiry").textContent = "N/A";
          document.getElementById('visacard').style.display = "block"
          document.getElementById('visaform').style.display = "none"
          alertClass = "alert-success";
          let result = '';
          for (let i = 0; i < 10; i++) {
            result += Math.floor(Math.random() * 10);
          }
          document.getElementById("mrcode1").textContent='VCJCHANN'+result+'<<<<<<<<<<';
        } else if (score >= 60) {
          resultText = `<strong>ğŸ‰ æ­å–œï¼è¿™æ˜¯æ‚¨çš„ä¸Šæµ·ç­¾è¯ï¼Œä½ ç°åœ¨å¯ä»¥å…¥å¢ƒä¸Šæµ·</strong>`;
          document.getElementById("duration").textContent = "60";
          const now = new Date();
          now.setDate(now.getDate() + 60);
          const newDay = now.getDate().toString().padStart(2, '0');
          const monthArr = ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];
          const newMonthStr = monthArr[now.getMonth()];
          const newYear = now.getFullYear();
          document.getElementById("expiry").textContent = newDay + newMonthStr + newYear;
          alertClass = "alert-primary";
          document.getElementById('visacard').style.display = "block"
          document.getElementById('visaform').style.display = "none"
          let result = '';
          for (let i = 0; i < 10; i++) {
            result += Math.floor(Math.random() * 10);
          }
          document.getElementById("mrcode1").textContent='VCJCHANN'+result+'<<<<<<<<<<';
        } else if (score >= 40) {
          resultText = `<strong>ğŸ‰ æ­å–œï¼è¿™æ˜¯æ‚¨çš„ä¸Šæµ·ç­¾è¯ï¼Œä½ ç°åœ¨å¯ä»¥å…¥å¢ƒä¸Šæµ·</strong>`;
          document.getElementById("duration").textContent = "15";
          const now = new Date();
          now.setDate(now.getDate() + 15);
          const newDay = now.getDate().toString().padStart(2, '0');
          const monthArr = ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];
          const newMonthStr = monthArr[now.getMonth()];
          const newYear = now.getFullYear();
          document.getElementById("expiry").textContent = newDay + newMonthStr + newYear;
          alertClass = "alert-warning";
          document.getElementById('visacard').style.display = "block"
          document.getElementById('visaform').style.display = "none"
          let result = '';
          for (let i = 0; i < 10; i++) {
            result += Math.floor(Math.random() * 10);
          }
          document.getElementById("mrcode1").textContent='VCJCHANN'+result+'<<<<<<<<<<';
        } else {
          resultText = `<strong>æ ¹æ®ä¸Šæµ·å¸‚äººæ°‘æ”¿åºœè¦æ±‚ï¼Œä¸èƒ½ç»™ä½ ä¸Šæµ·ç­¾è¯ï¼Œè¿™æ¬¡å†³å®šä¸å¯ç”³è¯‰ï¼Œä½ è¢«ç¦æ­¢å…¥å¢ƒä¸Šæµ·å¸‚åŒºï¼ŒåŒ…æ‹¬é»„æµ¦åŒºã€å¾æ±‡åŒºã€é™å®‰åŒºã€é•¿å®åŒºã€æ™®é™€åŒºã€è™¹å£åŒºã€æ¨æµ¦åŒºã€‚ä½ å¯ä»¥è¿›å…¥å˜‰å®šåŒºï¼Œè¿™æ˜¯å…ç­¾çš„ã€‚</strong>ä½ å¯ä»¥åœ¨ä½ çš„ä¸ªäººæƒ…å†µå‘ç”Ÿæ”¹å˜åå†æ¬¡ç”³è¯·ä¸Šæµ·ç­¾è¯ã€‚`;
          document.getElementById("duration").textContent = "";
          document.getElementById("expiry").textContent = "";
          alertClass = "alert-danger";
          document.getElementById('visacard').style.display = "none"
          document.getElementById('visaform').style.display = "none"
        }
    
        const resultDiv = document.getElementById("resultArea");
        resultDiv.innerHTML = resultText;
        resultDiv.className = `alert mt-3 ${alertClass}`;
        resultDiv.style.display = "block";
      }
      function formatToday() {
      const now = new Date();
      const day = now.getDate().toString().padStart(2, '0');
      const monthNames = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", 
                          "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
      const month = monthNames[now.getMonth()];
      const year = now.getFullYear();
    
      return `${day}${month}${year}`;
    }
    
    window.addEventListener("DOMContentLoaded", () => {
      document.getElementById("issue").textContent = formatToday();
    });
    
        const updateVisa = () => {
          const name = document.getElementById("fullName").value;
          const gender = document.getElementById("gender").value;
          const birth = document.getElementById("birthDate").value;
          const passport = document.getElementById("passportNumber").value;
          const purpose = document.getElementById("purpose").value;
    
          document.getElementById("name").textContent = name;
          document.getElementById("sex").textContent = gender;
          document.getElementById("birth").textContent = birth;
          document.getElementById("passport").textContent = passport;
          document.getElementById("cat").textContent = purpose;
          document.getElementById("mrcode1").textContent = `VCJCHANN<<<<<<<<<<`;
          document.getElementById("mrcode2").textContent = passport + "<<<<<<<<<<";
        };
    
        document.getElementById("fullName").addEventListener("input", updateVisa);
        document.getElementById("gender").addEventListener("input", updateVisa);
        document.getElementById("birthDate").addEventListener("input", updateVisa);
        document.getElementById("passportNumber").addEventListener("input", updateVisa);
        document.getElementById("purpose").addEventListener("input", updateVisa);
        document.getElementById("photoUpload").addEventListener("change", function () {
          const file = this.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
              document.getElementById("visaPhoto").src = e.target.result;
            };
            reader.readAsDataURL(file);
          }
        });
    </script>
</body>

</html>
